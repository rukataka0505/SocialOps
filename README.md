# 📅 SocialOps（ソーシャルオプス）

**「『いつ・誰が・何をやるか』が一目でわかる。SNS運用チームのためのカレンダー型ワークスペース。」**

これまでの「スプレッドシート（エクセル）での管理」や「チャットツールを行き来する連絡」からチームを解放し、**「もっと企画や制作に集中できる環境」**を提供します。

---

## 🌟 現場の負担を減らす、2つの強力な機能

SocialOpsが他のツールと決定的に違うのは、**「SNS運用の現場」**を徹底的に研究して作られている点です。特に以下の2つの機能が、毎日のストレスを激減させます。

### 1. 💬 「あの件どうなった？」がなくなる『タスク内チャット』

普段、LINEやSlackで「例の投稿の件ですが…」と連絡していませんか？ どの投稿の話か探すのに時間がかかったり、大事な指示が流れてしまったりする問題は、これで解決します。

- **タスクの中にチャットルームがある**  
  すべてのタスクに、専用のチャット機能がついています。指示も、質問も、修正依頼も、すべてそのタスクの中で完結します。

- **文脈がズレない**  
  タスクを開けば、そこには過去のやり取りが全て残っています。「いつ言った？」「聞いてない」というトラブルがゼロになります。

- **自分に関係ある通知だけ届く**  
  「タスクを振られた」「コメントが来た」など、自分に関係のある時だけ通知が届くので、重要な情報を見逃しません。

### 2. 🔗 投稿までの工程を見える化する『親子タスク』

「10/1にInstagram投稿」といっても、その裏には「台本作成」「画像作成」「動画編集」「チェック」など、たくさんの工程がありますよね？ SocialOpsは、これらを**「親タスク（投稿）」と「子タスク（作業）」**として整理できます。

- **1つの投稿を分解して管理**  
  「Instagram投稿（親）」の中に、「台本」「撮影」「編集（子）」といった細かいタスクをぶら下げることができます。

- **進捗が勝手に見える**  
  子タスクを完了させていくと、親タスクの進捗バーが自動で進みます。マネージャーは「今、動画編集の段階だな」と一目で状況を把握できます。

- **承認フローの自動化**  
  すべての子タスクが終わると、親タスクが自動的に「確認待ち」ステータスに変わるなど、チームの連携をシステムがサポートします。

---

## 💡 その他の基本機能

### 📅 「カレンダー」ですべてを支配する（ダッシュボード）

トップ画面はリストではなく、大きなカレンダーです。

- **一目でわかる**  
  1ヶ月の投稿スケジュールがパッと見で把握できます。

- **直感的な操作**  
  「投稿日を変えたい」と思ったら、マウスでタスクをドラッグ＆ドロップするだけで日程変更が完了します。

- **チームの負荷状況**  
  画面右側にはメンバーリストが常駐。誰が何件のタスクを抱えているかがリアルタイムで表示されるため、忙しい人へのフォローもすぐに判断できます。

### 🔑 安心・安全な「招待コード」システム

チームへの参加方法は、セキュリティ重視の**「招待コード方式」**です。

- **簡単ステップ**  
  アカウントを作って、管理者から教えられたコードを入力するだけ。

- **誤爆防止**  
  間違ってリンクを送ってしまっても、コードを知らなければ参加できないため安心です。

### 🛠 案件ごとの「専用コックピット」

クライアント（案件）ごとに、必要な情報だけを表示します。

- **アカウント情報の管理**  
  SNSのIDやパスワードを安全に保存。「パスワード忘れた！」がなくなります。

- **進行表モード**  
  余計な情報を隠し、シンプルなリスト形式で投稿漏れがないかチェックできます。

---

## 🚀 導入のメリットまとめ

技術的な知識は一切不要です。アカウントを作ってコードを入力するだけで、すぐにチームとして使い始めることができます。

- **「会話」が変わる**  
  「Slack見てください」ではなく、「タスクにコメント入れました」で済みます。

- **「確認」が減る**  
  「どこまで進んでる？」と聞かなくても、進捗バーを見ればわかります。

- **「ミス」が消える**  
  やるべき作業（子タスク）がリスト化されているので、作業漏れがなくなります。

まさに、**「考えるのは企画だけ。運用はカレンダーが回す」**を実現するツールです。

---

## 🛠 技術スタック

- **フレームワーク**: Next.js 15 (App Router)
- **言語**: TypeScript
- **データベース & 認証**: Supabase (PostgreSQL + SSR)
- **UI**: Tailwind CSS, Shadcn UI
- **日付処理**: date-fns, date-fns-tz (Asia/Tokyo)
- **カレンダー**: react-big-calendar
- **ドラッグ&ドロップ**: @dnd-kit/core
- **データフェッチング**: SWR

---

## 📦 セットアップ手順

### 1. リポジトリのクローン

```bash
git clone <repository-url>
cd SocialOps
```

### 2. 依存関係のインストール

```bash
npm install
```

### 3. 環境変数の設定

`.env.local.example`を`.env.local`にコピーし、必要な値を設定:

```bash
cp .env.local.example .env.local
```

以下の環境変数を設定してください:

- `NEXT_PUBLIC_SUPABASE_URL`: SupabaseプロジェクトのURL
- `NEXT_PUBLIC_SUPABASE_ANON_KEY`: Supabaseの匿名キー
- `SUPABASE_SERVICE_ROLE_KEY`: Supabaseのサービスロールキー

### 4. Supabaseのセットアップ

Supabaseプロジェクトを作成し、マイグレーションを実行:

```bash
# Supabase CLIのインストール（未インストールの場合）
npm install -g supabase

# Supabaseプロジェクトにリンク
npx supabase link --project-ref <your-project-ref>

# マイグレーションの実行
npx supabase db push
```

### 5. 開発サーバーの起動

```bash
npm run dev
```

ブラウザで [http://localhost:3000](http://localhost:3000) を開いてください。

---

## 📂 プロジェクト構成

```
SocialOps/
├── app/                          # Next.js App Router
│   ├── (auth)/                   # 認証関連ページ
│   │   └── login/                # ログインページ
│   ├── (dashboard)/              # ダッシュボード（メイン機能）
│   │   ├── layout.tsx            # 共通レイアウト（ヘッダー含む）
│   │   ├── dashboard/            # カレンダー＆タスクビュー
│   │   ├── ops/                  # 投稿管理（案件一覧）
│   │   ├── management/           # 案件設定
│   │   ├── clients/[id]/         # 案件コックピット
│   │   ├── settings/             # チーム設定
│   │   └── team/members/         # メンバー管理
│   ├── invite/[token]/           # チーム招待
│   ├── onboarding/               # オンボーディング
│   └── auth/                     # 認証コールバック
├── components/                   # Reactコンポーネント
│   ├── dashboard/                # ダッシュボード関連
│   │   ├── header.tsx            # ヘッダー（ナビゲーション）
│   │   ├── calendar-board.tsx    # 月次カレンダービュー
│   │   ├── weekly-board.tsx      # 週次カンバンボード
│   │   ├── my-tasks.tsx          # 個人タスクリスト
│   │   ├── team-panel.tsx        # メンバーリスト
│   │   └── notification-bell.tsx # 通知ベル
│   ├── tasks/                    # タスク管理
│   │   ├── task-dialog.tsx       # タスク作成・編集
│   │   └── task-detail-dialog.tsx # タスク詳細
│   ├── clients/                  # クライアント管理
│   │   ├── client-dialog.tsx     # クライアント編集
│   │   └── monthly-list-schedule.tsx # 月次進行表
│   ├── settings/                 # 設定関連
│   └── ui/                       # Shadcn UIコンポーネント
├── actions/                      # サーバーアクション
│   ├── auth.ts                   # 認証
│   ├── tasks.ts                  # タスク管理
│   ├── clients.ts                # クライアント管理
│   ├── teams.ts                  # チーム管理
│   ├── notifications.ts          # 通知
│   └── user.ts                   # ユーザープロフィール
├── lib/                          # ユーティリティ
│   ├── supabase/                 # Supabaseクライアント
│   ├── constants.ts              # システム定数
│   └── utils.ts                  # ヘルパー関数
├── types/                        # TypeScript型定義
│   └── database.types.ts         # Supabase型定義
├── supabase/                     # Supabase設定
│   └── migrations/               # DBマイグレーション
└── middleware.ts                 # 認証ミドルウェア
```

---

## 🗄️ データベース構造

主要テーブル:

- **users** - ユーザー情報
- **teams** - チーム情報（`settings` JSONBでワークフロー設定を保存）
- **team_members** - チームメンバー（ロール管理: Owner / Admin / Member）
- **team_invitations** - チーム招待コード
- **clients** - クライアント情報（`credentials`, `resources` JSONBで拡張情報を保存）
- **tasks** - タスク（`attributes` JSONBでカスタムフィールド対応、親子構造サポート）
- **task_assignments** - タスク担当者（複数割り当て対応）
- **notifications** - 通知（リアルタイム更新対応）

すべてのテーブルで `deleted_at` によるソフトデリートを実装。

---

## ✨ 主要機能一覧

### 認証 & チーム管理
- ✅ Supabase Auth による認証
- ✅ メールアドレス確認フロー
- ✅ 招待コードによるチームメンバー追加
- ✅ ロールベースのアクセス制御（Owner / Admin / Member）
- ✅ マルチチーム対応（チーム切り替え機能）

### カレンダー & ダッシュボード
- ✅ **月次カレンダー**: スマートスタック表示（3件以下は全表示、4件以上は省略表示）
- ✅ **週次カンバンボード**: 曜日ごとのリスト形式でタスクを管理
- ✅ **日別タスクリスト**: 日付クリックでその日のタスク一覧をポップアップ表示
- ✅ **ドラッグ&ドロップ**: 直感的に日程変更
- ✅ **個人タスクフィルタリング**: 自分に関係のあるタスクのみ表示

### タスク管理
- ✅ **親子タスク構造**: 投稿（親）と制作工程（子）を階層管理
- ✅ **タスク内チャット**: タスクごとの専用コメント機能
- ✅ **複数担当者アサイン**: 1つのタスクに複数人を割り当て可能
- ✅ **カスタムフィールド**: チーム設定に応じた動的な入力項目
- ✅ **ワークフローステータス**: チームごとにカスタマイズ可能
- ✅ **サブタスク管理**: 進捗バーで自動的に進行状況を可視化
- ✅ **提出物管理**: URL提出・編集機能
- ✅ **個人/チームタスク区分**: プライベートタスクとチームタスクの切り替え

### 通知システム
- ✅ ヘッダーのベルアイコンによるリアルタイム通知
- ✅ 「自分に関係のあるタスク」のみを通知（担当割り当て、コメント、提出）
- ✅ 未読管理と一括既読化
- ✅ 通知クリックで該当タスクへディープリンク遷移

### ワークフロー自動化
- ✅ 子タスク完了時の親タスク自動進行（全サブタスク完了 → 親タスク「確認待ち」）
- ✅ 子タスク差し戻し時の親タスク自動復帰（サブタスク未完了 → 親タスク「進行中」）
- ✅ ステータス自動変更時の通知送信

### クライアント管理
- ✅ クライアント情報の CRUD
- ✅ アカウント情報（credentials）とリソースリンク（resources）の管理
- ✅ 案件コックピット（進行表のみのシンプルUI）
- ✅ 月次進行表（日付ごとの縦並びリスト形式）
- ✅ ソフトデリート対応

### チーム設定
- ✅ ワークフローステータスのカスタマイズ
- ✅ カスタム入力項目の定義（テキスト、URL、日付、選択肢）
- ✅ 設定内容はタスクダイアログに自動反映

### メンバー管理
- ✅ メンバー詳細ダイアログ
- ✅ 未完了タスク一覧表示
- ✅ 期限切れタスクのハイライト
- ✅ ロール変更機能（権限に応じて）

---

## 🎯 開発コマンド

```bash
# 開発サーバー起動
npm run dev

# プロダクションビルド
npm run build

# プロダクションサーバー起動
npm start

# リント実行
npm run lint

# バックアップ（Git）
npm run backup

# 本番デプロイ
npm run deploy:prod
```

---

## 📄 ライセンス

ISC

---

## 🙏 サポート

質問や問題がある場合は、GitHubのIssuesセクションでお知らせください。
